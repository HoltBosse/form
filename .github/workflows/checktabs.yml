name: Check Tabs in Codebase

on: [push]

jobs:
  check-tabs:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Find files with leading spaces
        run: |
          echo "üîç Scanning for files with space-indented lines..."

          OFFENDING_FILES=()
          while IFS= read -r -d '' file; do
            if grep -qP '^( )+' "$file"; then
              echo "‚ùå File: $file"
              grep -n -P '^( )+' "$file"
              OFFENDING_FILES+=("$file")
            fi
          done < <(find . -type f \
              ! -path "./.git/*" \
              ! -name "*.yml" ! -name "*.md" \
              -print0)

          echo ""
          COUNT=${#OFFENDING_FILES[@]}
          if [ "$COUNT" -gt 0 ]; then
            echo "üö´ $COUNT file(s) contain lines that use spaces for indentation."
            exit 1
          else
            echo "‚úÖ All files use tab indentation as expected."
          fi
